<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ò—Å—Ç–æ—Ä–∏—è –ù–µ–¥–µ–ª–∏ 1: –ê—Ä—Ç–∏–∫–ª–∏ (A1)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* (–°—Ç–∏–ª–∏ –∫–≤–∏–∑–∞ –∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –Ω–µ –º–µ–Ω—è—é—Ç—Å—è) */
        .modal { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease; transform: scale(0.95); }
        .modal.is-open { opacity: 1; }
        .modal.is-open .modal-content { transform: scale(1); }
        .quiz-option { transition: all 0.15s ease; outline: none; }
        .quiz-option:hover { transform: translateY(-2px); box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.1); }
        .quiz-selected { background-color: #A5B4FC !important; color: #1E3A8A !important; border-color: #6366F1 !important; box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.5); }
        .quiz-correct { background-color: #D1FAE5 !important; color: #065F46 !important; border-color: #34D399 !important; }
        .quiz-wrong { background-color: #FEE2E2 !important; color: #991B1B !important; border-color: #F87171 !important; }

        /* ------------------------------------------- */
        /* –°–¢–ò–õ–ò –î–õ–Ø –ê–£–î–ò–û/–ö–ê–†–¢–ò–ù–ö–ò –ò –ê–ö–ö–û–†–î–ï–û–ù–û–í */
        /* ------------------------------------------- */
        .accordion-header {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            opacity: 0;
            visibility: hidden;
            padding: 0 1rem; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –±–µ–∑ –ø–∞–¥–¥–∏–Ω–≥–∞ */
        }
        /* –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º padding –æ–±—Ä–∞—Ç–Ω–æ –∏ –≤–∫–ª—é—á–∞–µ–º —Å–∫—Ä–æ–ª–ª */
        .accordion-content.is-open {
            /* –£–í–ï–õ–ò–ß–ï–ù–ê –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –í–´–°–û–¢–ê –î–õ–Ø –£–î–û–ë–ù–û–ô –ü–†–û–ö–†–£–¢–ö–ò */
            max-height: 90vh; /* –ò–ó–ú–ï–ù–ï–ù–û —Å 80vh –Ω–∞ 90vh */
            opacity: 1;
            visibility: visible;
            overflow-y: auto; /* –í–ö–õ–Æ–ß–ê–ï–ú –°–ö–†–û–õ–õ –í–ù–£–¢–†–ò –ë–õ–û–ö–ê */
            padding: 1rem; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–∞–¥–¥–∏–Ω–≥ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <div id="app" class="max-w-md mx-auto">
        
        <div class="mb-4">
            <button onclick="window.App.notifyParentToReturn('week-content')" class="text-gray-500 hover:text-indigo-600 font-semibold flex items-center transition duration-150">
                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                ‚Üê –ö –ö–æ–Ω—Ç–µ–Ω—Ç—É –ù–µ–¥–µ–ª–∏
            </button>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-lg">

            <div id="audio-player" class="mb-6">
                <audio id="story-audio" controls class="w-full">
                    <source src="https://example.com/audio/story_week1.mp3" type="audio/mp3">
                    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ—ç–ª–µ–º–µ–Ω—Ç.
                </audio>
            </div>
            
            <div class="mb-6 rounded-lg overflow-hidden shadow-md">
                <img id="story-image" src="https://placehold.co/600x300/FEE2E2/991B1B?text=–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è+–∫+–ò—Å—Ç–æ—Ä–∏–∏" alt="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∫ –∏—Å—Ç–æ—Ä–∏–∏" class="w-full h-auto">
            </div>

            <div id="story-content" class="space-y-4 text-gray-700">
                <p><strong>Die Familie M√ºller geht in die Stadt.</strong> Herr M√ºller hat eine Tasche. Die Tasche ist gro√ü. Frau M√ºller hat eine Blume. Die Blume ist rot. Das Kind hat ein Spielzeug. Das Spielzeug ist klein.</p>
                <p>Der Hund l√§uft schnell. Er sieht einen Baum. Der Baum ist hoch. Die Sonne scheint. Das Wetter ist sch√∂n. Sie kaufen Brot und K√§se.</p>
                <p>Am Abend sehen sie den Film. Es ist ein guter Film. Die Familie ist gl√ºcklich. Sie lernen neue W√∂rter: der Baum, die Tasche, das Kind, das Spielzeug.</p>
                <p class="text-sm italic mt-4 text-gray-500">Diese Kurzgeschichte –∑–Ω–∞–∫–æ–º–∏—Ç –≤–∞—Å —Å –±–∞–∑–æ–≤—ã–º–∏ –∞—Ä—Ç–∏–∫–ª—è–º–∏ A1.</p>
            </div>

            <hr class="my-6 border-gray-200">

            <div id="accordion-transcript" class="mb-4 border border-gray-200 rounded-lg overflow-hidden">
                <div id="transcript-header" class="accordion-header p-4 bg-gray-50 hover:bg-gray-100 flex justify-between items-center text-gray-800 font-semibold" onclick="window.App.toggleAccordion('transcript')">
                    <span>–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç (–ù–µ–º–µ—Ü–∫–∏–π)</span>
                    <span id="transcript-icon" class="text-lg">‚ñº</span>
                </div>
                <div id="transcript-content" class="accordion-content">
                    <div class="space-y-3 text-sm">
                        <p><strong>Die Familie M√ºller geht in die Stadt.</strong> Herr M√ºller hat eine Tasche. Die Tasche ist gro√ü. Frau M√ºller hat eine Blume. Die Blume ist rot. Das Kind hat ein Spielzeug. Das Spielzeug ist klein.</p>
                        <p>Der Hund l√§uft schnell. Er sieht einen Baum. Der Baum ist hoch. Die Sonne scheint. Das Wetter ist sch√∂n. Sie kaufen Brot und K√§se.</p>
                        <p>Am Abend sehen sie den Film. Es ist ein guter Film. Die Familie ist gl√ºcklich. Sie lernen neue W√∂rter: der Baum, die Tasche, das Kind, das Spielzeug.</p>
                        <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>–ï—â—ë –±–æ–ª—å—à–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏. Curabitur pretium, libero et accumsan commodo, nisi nisi consectetur purus, in scelerisque leo lorem vel erat. Donec vitae nunc sit amet felis bibendum facilisis. Nam facilisis, sapien eu fermentum tristique, elit erat fermentum erat, vel facilisis nisi nisl vitae ligula. Fusce tincidunt, quam vitae posuere tincidunt, eros velit lacinia ipsum, non consectetur arcu mi eu nulla. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
                        <p>–ò –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–ª–æ–∫, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∫—Ä–æ–ª–ª–±–∞—Ä –ø–æ—è–≤–∏–ª—Å—è. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.</p>
                    </div>
                </div>
            </div>

            <div id="accordion-analysis" class="mb-6 border border-gray-200 rounded-lg overflow-hidden">
                <div id="analysis-header" class="accordion-header p-4 bg-gray-50 hover:bg-gray-100 flex justify-between items-center text-gray-800 font-semibold" onclick="window.App.toggleAccordion('analysis')">
                    <span>–†–∞–∑–±–æ—Ä —Å–ª–æ–≤ –∏ –∞—Ä—Ç–∏–∫–ª–µ–π</span>
                    <span id="analysis-icon" class="text-lg">‚ñº</span>
                </div>
                <div id="analysis-content" class="accordion-content">
                    <div class="space-y-3 text-sm">
                        <p><strong>Der</strong> Baum (–º—É–∂—Å–∫–æ–π —Ä–æ–¥) ‚Äî –¥–µ—Ä–µ–≤–æ. –ó–∞–ø–æ–º–Ω–∏—Ç–µ: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏—Ä–æ–¥–æ–π (–∫—Ä–æ–º–µ —Ü–≤–µ—Ç–æ–≤), –∏–º–µ—é—Ç –∞—Ä—Ç–∏–∫–ª—å 'Der'.</p>
                        <p><strong>Die</strong> Tasche (–∂–µ–Ω—Å–∫–∏–π —Ä–æ–¥) ‚Äî —Å—É–º–∫–∞. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª–æ–≤, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏—Ö—Å—è –Ω–∞ -e, –∏–º–µ—é—Ç –∞—Ä—Ç–∏–∫–ª—å 'Die'.</p>
                        <p><strong>Das</strong> Kind (—Å—Ä–µ–¥–Ω–∏–π —Ä–æ–¥) ‚Äî —Ä–µ–±–µ–Ω–æ–∫. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å.</p>
                        <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∫—Ä–æ–ª–ª–∞: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    </div>
                </div>
            </div>

            <hr class="my-6 border-gray-200">

            <div id="quiz-section">
                <h2 class="text-xl font-bold text-gray-800 mb-4">–ú–∏–Ω–∏-–ö–≤–∏–∑: –ê—Ä—Ç–∏–∫–ª–∏</h2>
                <div id="quiz-container" class="space-y-4">
                    </div>
                <button id="submit-quiz-button" onclick="window.App.submitQuiz()" class="w-full py-3 mt-6 bg-green-500 text-white font-bold rounded-xl shadow-md hover:bg-green-600 transition duration-150 hidden">
                    –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã
                </button>
            </div>

            <div class="text-center pt-8">
                <button onclick="window.App.notifyParentToReturn('week-content')" class="text-gray-500 hover:text-indigo-600 font-semibold transition duration-150">
                    &larr; –ù–∞–∑–∞–¥ –∫ –ö–æ–Ω—Ç–µ–Ω—Ç—É –ù–µ–¥–µ–ª–∏
                </button>
            </div>

        </div>
    </div>
    
    <div id="result-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 opacity-0" onclick="window.App.closeModal('result-modal')">
        <div id="result-modal-content" class="modal-content bg-white p-6 rounded-xl shadow-xl max-w-sm w-full transform scale-95" onclick="event.stopPropagation()">
            <h3 id="result-title" class="text-2xl font-bold mb-3 text-center text-gray-800"></h3>
            <p id="result-body" class="text-gray-700 mb-5 text-center"></p>
            <button onclick="window.App.closeModal('result-modal')" class="w-full py-3 px-4 bg-blue-500 text-white font-bold rounded-xl shadow-md hover:bg-blue-600">
                –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            </button>
        </div>
    </div>

    <script>
        const QUIZ_DATA = [
            { question: "–ö–∞–∫–æ–π –∞—Ä—Ç–∏–∫–ª—å —É —Å–ª–æ–≤–∞ 'Tisch' (—Å—Ç–æ–ª)?", answer: "Der", options: ["Der", "Die", "Das"], correctMessage: "–í–µ—Ä–Ω–æ! Der Tisch.", wrongMessage: "–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞—Ä—Ç–∏–∫–ª—å Der." },
            { question: "–ö–∞–∫–æ–π –∞—Ä—Ç–∏–∫–ª—å —É —Å–ª–æ–≤–∞ 'Blume' (—Ü–≤–µ—Ç–æ–∫)?", answer: "Die", options: ["Der", "Die", "Das"], correctMessage: "–í–µ—Ä–Ω–æ! Die Blume.", wrongMessage: "–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞—Ä—Ç–∏–∫–ª—å Die." },
            { question: "–ö–∞–∫–æ–π –∞—Ä—Ç–∏–∫–ª—å —É —Å–ª–æ–≤–∞ 'Kind' (—Ä–µ–±–µ–Ω–æ–∫)?", answer: "Das", options: ["Der", "Die", "Das"], correctMessage: "–í–µ—Ä–Ω–æ! Das Kind.", wrongMessage: "–ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞—Ä—Ç–∏–∫–ª—å Das." }
        ];

        window.App = {
            quizAnswers: {}, 
            
            init() {
                this.renderQuiz();
                this.initAudioPlayback();
                this.checkSubmitButtonVisibility();
                
                // –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º id, —á—Ç–æ–±—ã —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –º–æ–≥ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω
                document.body.setAttribute('data-app-loaded', 'true');
            },
            
            initAudioPlayback() {
                const audio = document.getElementById('story-audio');
                if (audio) {
                    audio.onplay = () => {
                        // –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞—É–¥–∏–æ —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã
                        this.closeAllAccordions();
                    };
                }
            },
            
            renderQuiz() {
                const container = document.getElementById('quiz-container');
                container.innerHTML = '';
                
                QUIZ_DATA.forEach((q, index) => {
                    const questionEl = document.createElement('div');
                    questionEl.className = 'bg-gray-50 p-4 rounded-xl shadow-sm border border-gray-200';
                    questionEl.innerHTML = `
                        <p class="font-semibold text-gray-700 mb-3">${index + 1}. ${q.question}</p>
                        <div id="options-${index}" class="grid grid-cols-3 gap-2">
                            ${q.options.map(option => `
                                <button onclick="window.App.selectOption(${index}, '${option.replace(/'/g, "\\'")}')" 
                                        class="quiz-option py-2 px-3 border border-indigo-300 rounded-lg text-sm text-center bg-white text-indigo-700 font-medium hover:bg-indigo-50">
                                    ${option}
                                </button>
                            `).join('')}
                        </div>
                        <p id="feedback-${index}" class="text-sm mt-3 font-medium hidden"></p>
                    `;
                    container.appendChild(questionEl);
                });
            },
            
            selectOption(qIndex, selectedValue) {
                this.quizAnswers[qIndex] = selectedValue;
                const optionContainer = document.getElementById(`options-${qIndex}`);
                const options = optionContainer.querySelectorAll('button');
                
                options.forEach(button => {
                    button.classList.remove('quiz-selected');
                    if (button.textContent.trim() === selectedValue.trim()) {
                        button.classList.add('quiz-selected');
                    }
                });
                
                this.checkSubmitButtonVisibility();
            },
            
            checkSubmitButtonVisibility() {
                const allAnswered = QUIZ_DATA.every((_, index) => this.quizAnswers.hasOwnProperty(index));
                const submitButton = document.getElementById('submit-quiz-button');
                
                if (allAnswered) {
                    submitButton.classList.remove('hidden');
                } else {
                    submitButton.classList.add('hidden');
                }
            },
            
            submitQuiz() {
                let correctCount = 0;
                
                QUIZ_DATA.forEach((q, index) => {
                    const isCorrect = this.quizAnswers[index] === q.answer;
                    const optionContainer = document.getElementById(`options-${index}`);
                    const feedbackEl = document.getElementById(`feedback-${index}`);
                    
                    optionContainer.querySelectorAll('button').forEach(button => {
                        button.disabled = true; // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                        
                        // –£–¥–∞–ª—è–µ–º —Å—Ç–∏–ª–∏ –≤—ã–±–æ—Ä–∞
                        button.classList.remove('quiz-selected'); 
                        
                        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                        if (button.textContent.trim() === q.answer.trim()) {
                            button.classList.add('quiz-correct');
                        } else if (button.textContent.trim() === this.quizAnswers[index].trim()) {
                            button.classList.add('quiz-wrong');
                        }
                    });

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–¥–±–µ–∫
                    feedbackEl.textContent = isCorrect ? q.correctMessage : `${q.wrongMessage} –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.answer}`;
                    feedbackEl.classList.remove('hidden', isCorrect ? 'text-red-600' : 'text-green-600');
                    feedbackEl.classList.add(isCorrect ? 'text-green-600' : 'text-red-600');

                    if (isCorrect) {
                        correctCount++;
                    }
                });

                document.getElementById('submit-quiz-button').classList.add('hidden');
                this.showResultModal(correctCount);
            },
            
            showResultModal(correctCount) {
                const total = QUIZ_DATA.length;
                const title = correctCount === total ? "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ" : "–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!";
                const body = `–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ ${correctCount} –∏–∑ ${total} –≤–æ–ø—Ä–æ—Å–æ–≤.`;
                
                document.getElementById('result-title').textContent = title;
                document.getElementById('result-body').textContent = body;
                this.openModal('result-modal');
            },
            
            toggleAccordion(type) {
                const content = document.getElementById(`${type}-content`);
                const icon = document.getElementById(`${type}-icon`);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –æ—Ç–∫—Ä—ã—Ç —ç—Ç–æ—Ç –∞–∫–∫–æ—Ä–¥–µ–æ–Ω
                const wasOpen = content.classList.contains('is-open');
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã
                this.closeAllAccordions();

                // –ï—Å–ª–∏ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω –±—ã–ª –∑–∞–∫—Ä—ã—Ç, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ
                if (!wasOpen) {
                    content.classList.add('is-open');
                    icon.textContent = '‚ñ≤';
                }
            },
            
            closeAllAccordions() {
                ['transcript', 'analysis'].forEach(type => {
                    const content = document.getElementById(`${type}-content`);
                    const icon = document.getElementById(`${type}-icon`);
                    if (content) {
                        content.classList.remove('is-open');
                    }
                    if (icon) {
                         icon.textContent = '‚ñº';
                    }
                });
            },
            
            // ============ UTILITY LOGIC (Open Links, Modals, etc.) ============
            
            /**
             * –°–æ–æ–±—â–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–∫–Ω—É (index.html), —á—Ç–æ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω.
             * @param {string} targetScreen - –≠–∫—Ä–∞–Ω –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ ('home-screen', 'weekly-selections', 'week-content').
             */
            notifyParentToReturn(targetScreen) {
                if (window.parent && window.parent.App) {
                    if (targetScreen === 'week-content' && typeof window.parent.App.renderWeekContent === 'function') {
                        // –í–æ–∑–≤—Ä–∞—Ç –∫ –ö–æ–Ω—Ç–µ–Ω—Ç—É –ù–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è –±–µ—Ä–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–æ–¥–∏—Ç–µ–ª—è)
                        const weekNum = window.parent.App.selectedWeek || 1;
                        window.parent.App.renderWeekContent(weekNum);
                    } else if (targetScreen === 'weekly-selections' && typeof window.parent.App.renderWeeklySelections === 'function') {
                        // –í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É –Ω–µ–¥–µ–ª—å
                        window.parent.App.renderWeeklySelections();
                    } else if (typeof window.parent.App.renderHomeScreen === 'function') {
                        // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
                        window.parent.App.renderHomeScreen();
                    }
                } else if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.close) {
                    // –ï—Å–ª–∏ –Ω–µ –≤–æ —Ñ—Ä–µ–π–º–µ, –∑–∞–∫—Ä—ã–≤–∞–µ–º (–¥–ª—è –ø—Ä—è–º–æ–π –æ—Ç–ª–∞–¥–∫–∏)
                    window.Telegram.WebApp.close();
                } else {
                    console.log(`–≠–º—É–ª—è—Ü–∏—è: –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω ${targetScreen}.`);
                }
            },

            openModal(modalId) {
                const modal = document.getElementById(modalId);
                const modalContent = document.querySelector(`#${modalId} .modal-content`); 
                
                if (modal) {
                    modal.classList.remove('hidden');
                    setTimeout(() => {
                        modal.classList.add('is-open', 'opacity-100');
                        if (modalContent) {
                            modalContent.classList.add('is-open');
                        }
                    }, 10);
                }
            },
            
            closeModal(modalId) {
                const modal = document.getElementById(modalId);
                const modalContent = document.querySelector(`#${modalId} .modal-content`); 
                
                if (modal) {
                    modal.classList.remove('is-open', 'opacity-100');
                    if (modalContent) {
                        modalContent.classList.remove('is-open');
                    }
                    setTimeout(() => {
                        modal.classList.add('hidden');
                    }, 300);
                }
            }
        };
        
        window.addEventListener('load', () => {
            window.App.init();
        });
    </script>
</body>
</html>