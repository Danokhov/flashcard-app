<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Немецкий по неделям</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        .card { perspective: 1000px; }
        .card-inner { position: relative; transition: transform 0.6s; transform-style: preserve-3d; }
        .card.is-flipped .card-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; top: 0; left: 0; }
        .card-back { transform: rotateY(180deg); }

        @keyframes slide-left { from { transform: translateX(0); opacity: 1; } to { transform: translateX(-100%); opacity: 0; } }
        @keyframes slide-in-right { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .card.slide-out { animation: slide-left 0.4s ease forwards; }
        .card.slide-in { animation: slide-in-right 0.4s ease; }

        .modal { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease; transform: scale(0.95); }
        .modal.is-open { opacity: 1; }
        .modal.is-open .modal-content { transform: scale(1); }

        .button-locked { background-color: #e5e7eb; color: #6b7280; cursor: not-allowed; opacity: 0.7; }

        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body class="min-h-screen bg-gray-100 font-sans p-4">

    <div id="app" class="max-w-md mx-auto">

        <!-- Экран загрузки -->
        <div id="loading-screen" class="text-center py-20">
            <p class="text-gray-500 text-xl">Загрузка...</p>
        </div>

        <!-- Главное меню (динамическое) -->
        <div id="home-screen" class="hidden">
            <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Немецкий по неделям</h1>
            <div class="space-y-5" id="home-buttons"></div>
            <div id="due-today-section" class="hidden mt-8 pt-6 border-t border-gray-300"></div>
        </div>

        <!-- Остальные экраны (оставил без изменений — они все работают) -->
        <div id="list-screen" class="hidden">
            <h1 id="list-title" class="text-2xl font-bold text-center mb-6 text-gray-800"></h1>
            <div id="back-button-container" class="mb-4"></div>
            <div id="filter-controls" class="mb-4"></div>
            <div id="content-list" class="space-y-4"></div>
        </div>

        <div id="video-content-screen" class="hidden">
            <div id="video-back-button-container" class="mb-4"></div>
            <h1 id="video-title" class="text-2xl font-bold text-center mb-6"></h1>
            <div class="video-container mb-6"><iframe id="video-embed" frameborder="0" allowfullscreen></iframe></div>
            <div id="video-extra-text" class="p-6 bg-white rounded-xl shadow-lg"></div>
        </div>

        <div id="study-screen" class="hidden">
            <div class="bg-gray-200 rounded-full h-3 mb-6 overflow-hidden"><div id="progress-bar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-full transition-all duration-500" style="width:0%"></div></div>
            <div id="card" class="card h-64 mb-6 cursor-pointer" onclick="window.App.showAnswer()">
                <div id="card-inner" class="card-inner h-full rounded-2xl shadow-2xl">
                    <div id="card-front" class="card-front bg-white flex items-center justify-center p-8 text-3xl font-bold text-gray-800 rounded-2xl">?</div>
                    <div id="card-back" class="card-back bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-8 text-3xl font-bold text-white rounded-2xl"></div>
                </div>
            </div>
            <div id="controls-show" class="space-y-4">
                <button onclick="window.App.showAnswer()" class="w-full py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold text-xl rounded-2xl shadow-lg hover:shadow-xl transition">Показать ответ</button>
                <button id="hint-button" onclick="window.App.showHint()" class="hidden w-full py-3 bg-yellow-400 text-yellow-900 font-bold rounded-xl">Подсказка</button>
            </div>
            <div id="controls-rate" class="hidden grid grid-cols-2 gap-4">
                <button onclick="window.App.handleAnswer(false)" class="py-5 bg-red-500 text-white font-bold text-xl rounded-2xl shadow-lg hover:bg-red-600">Не помню</button>
                <button onclick="window.App.handleAnswer(true)" class="py-5 bg-green-500 text-white font-bold text-xl rounded-2xl shadow-lg hover:bg-green-600">Помню</button>
            </div>
        </div>

        <!-- Остальные экраны (finish, modals и т.д.) — полностью рабочие, не трогал -->
        <!-- (всё из твоего оригинала, просто чуть почистил) -->

        <div id="finish-screen" class="hidden text-center py-20">
            <h2 class="text-4xl font-bold text-gray-800 mb-6">Молодец!</h2>
            <p class="text-xl text-gray-600 mb-8">Сессия завершена</p>
            <button onclick="window.App.renderHomeScreen()" class="py-4 px-8 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold text-2xl rounded-2xl shadow-xl">В меню</button>
        </div>
    </div>

    <!-- Модальные окна (hint + направление) -->
    <div id="hint-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50" onclick="window.App.closeModal('hint-modal')">
        <div class="bg-white p-6 rounded-2xl max-w-xs" onclick="event.stopPropagation()">
            <img id="hint-image" src="" class="w-full rounded-lg mb-4">
            <button onclick="window.App.closeModal('hint-modal')" class="w-full py-3 bg-gray-200 rounded-xl font-bold">Закрыть</button>
        </div>
    </div>

    <div id="direction-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50" onclick="window.App.closeDirectionModal()">
        <div class="bg-white p-8 rounded-2xl max-w-sm w-full" onclick="event.stopPropagation()">
            <h3 class="text-2xl font-bold text-center mb-6">Направление перевода</h3>
            <button onclick="window.App.startSessionWithDirection('ru-de')" class="w-full py-4 mb-3 bg-blue-600 text-white font-bold rounded-xl">Русский → Немецкий</button>
            <button onclick="window.App.startSessionWithDirection('de-ru')" class="w-full py-4 mb-3 bg-purple-600 text-white font-bold rounded-xl">Немецкий → Русский</button>
            <button onclick="window.App.closeDirectionModal()" class="w-full py-3 text-gray-600 font-bold">Отмена</button>
        </div>
    </div>

    <!-- Подключаем основной скрипт -->
    <script type="module" src="./app.js"></script>
</body>
</html>